# π“‘ μµμΆ… μ •λ¦¬: `CustomPOI_API_DOC.md` (Notion μ¤νƒ€μΌ, μ „μ²΄ Public λ©”μ†λ“ λ¬Έμ„ν™”)

## 1. κ°μ”
- CustomPOIλ” λ‹¤μ–‘ν• ν•νƒμ μ—‘μ…€ νμΌμ„ μƒμ„±ν•κ³  μ½μ„ μ μλ” μ ν‹Έλ¦¬ν‹°μ…λ‹λ‹¤.
- λ‹¤λ‹¨κ³„ ν—¤λ”, λ³‘ν•© μ…€, DTO λ§¤ν•‘ κΈ°λ° μ—‘μ…€ μλ™ν™” μ§€μ›
- μλ™ μ—΄ λ„λΉ„ μ΅°μ • κΈ°λ¥ ν¬ν•¨ (autoSizeColumn)

---

## 2. ExcelGenerator ν΄λμ¤

### 2.1. λ©”μ†λ“: generateExcel

#### 2.1.1. μ‹κ·Έλ‹μ²
```java
public static void generateExcel(OutputStream out, ExcelHeaderNode headerRoot, List<?> dataList, Map<String, ExcelStyle> bodyStyleMap) throws Exception
```

#### 2.1.2. κΈ°λ¥ μ„¤λ…
- μ£Όμ–΄μ§„ `headerRoot`λ¥Ό κΈ°λ°μΌλ΅ μ—‘μ…€ ν—¤λ”λ¥Ό μ‘μ„±ν•©λ‹λ‹¤.
- `dataList`λ¥Ό κΈ°λ°μΌλ΅ λ°”λ””(λ°μ΄ν„°) μμ—­μ„ μ±„μ›λ‹λ‹¤.
- `bodyStyleMap`μ„ ν†µν•΄ κ° ν•„λ“λ³„ μ¤νƒ€μΌμ„ μ μ©ν•  μ μμµλ‹λ‹¤.
- μ‘μ„± μ™„λ£ ν›„ **μ»¬λΌ λ„λΉ„λ¥Ό μλ™μΌλ΅ μ΅°μ •(autoSizeColumn)** ν•©λ‹λ‹¤. β…

---

#### 2.1.3. νλΌλ―Έν„°

| νλΌλ―Έν„°λ… | νƒ€μ… | μ„¤λ… |
|:---|:---|:---|
| out | OutputStream | μ—‘μ…€ νμΌμ„ μ¶λ ¥ν•  μ¤νΈλ¦Ό |
| headerRoot | ExcelHeaderNode | μ—‘μ…€ ν—¤λ”λ¥Ό μ •μν•λ” νΈλ¦¬ μµμƒμ„ λ…Έλ“ |
| dataList | List<?> | μ—‘μ…€μ— μ‘μ„±ν•  DTO κ°μ²΄ λ¦¬μ¤νΈ |
| bodyStyleMap | Map<String, ExcelStyle> | ν•„λ“λ³„ λ°”λ”” μ…€ μ¤νƒ€μΌ μ„¤μ • λ§µ |

---

#### 2.1.4. νΉμ§•
- λ‹¤λ‹¨κ³„ ν—¤λ” μ‘μ„± κ°€λ¥
- λ³‘ν•© μ…€(Merged Cell) μ§€μ›
- DTO ν•„λ“λ…κ³Ό λ§¤μΉ­ν•μ—¬ λ°μ΄ν„° μλ™ μ‘μ„±
- **μ—‘μ…€ μ €μ¥ μ§μ „μ— μ—΄ λ„λΉ„ μλ™ μµμ ν™”** μ μ©

---

#### 2.1.5. μ£Όμμ‚¬ν•­
- `ExcelHeaderNode` νΈλ¦¬μ **leaf λ…Έλ“ μμ„**κ°€ μ»¬λΌ μμ„λ¥Ό κ²°μ •ν•©λ‹λ‹¤.
- DTO ν΄λμ¤μ ν•„λ“λ…κ³Ό `ExcelHeaderNode`μ `fieldName`μ΄ μ •ν™•ν λ§¤μΉ­λμ–΄μ•Ό ν•©λ‹λ‹¤.
- μ¶”κ°€μ μΈ μ—΄ λ„λΉ„ μ΅°μ • μ½”λ“κ°€ ν•„μ” μ—†μµλ‹λ‹¤. (λ‚΄λ¶€ autoSize μ μ©)

---

### 2.2. λ©”μ†λ“: parseExcelToDto

#### 2.2.1. μ‹κ·Έλ‹μ²
```java
public static <T> List<T> parseExcelToDto(InputStream in, Class<T> dtoClass, int headerEndRow, ExcelHeaderNode headerRoot) throws Exception
```

#### 2.2.2. κΈ°λ¥ μ„¤λ…
- μ—‘μ…€ νμΌμ„ μ½μ–΄ `dtoClass` νƒ€μ…μ λ¦¬μ¤νΈλ΅ λ³€ν™ν•©λ‹λ‹¤.
- `headerEndRow` μ΄ν›„λ¶€ν„° λ°μ΄ν„° μμ—­μΌλ΅ μΈμ‹ν•μ—¬ λ°μ΄ν„°λ¥Ό μ½μµλ‹λ‹¤.
- `headerRoot`λ¥Ό κΈ°λ°μΌλ΅ **μ»¬λΌ μμ„**μ™€ **DTO ν•„λ“ λ§¤ν•‘**μ„ μν–‰ν•©λ‹λ‹¤.

---

#### 2.2.3. νλΌλ―Έν„°

| νλΌλ―Έν„°λ… | νƒ€μ… | μ„¤λ… |
|:---|:---|:---|
| in | InputStream | μ½μ–΄μ¬ μ—‘μ…€ νμΌ μ…λ ¥ μ¤νΈλ¦Ό |
| dtoClass | Class<T> | λ³€ν™ν•  DTO ν΄λμ¤ νƒ€μ… |
| headerEndRow | int | ν—¤λ”κ°€ λλ‚λ” ν–‰(row) μΈλ±μ¤ (0λ¶€ν„° μ‹μ‘) |
| headerRoot | ExcelHeaderNode | ν—¤λ” κµ¬μ΅°λ¥Ό μ •μν•λ” νΈλ¦¬ μµμƒμ„ λ…Έλ“ |

---

#### 2.2.4. νΉμ§•
- **Row λ‹¨μ„**λ΅ μ—‘μ…€ λ°μ΄ν„°λ¥Ό μ½μ–΄ DTOλ΅ λ³€ν™
- λ³‘ν•© μ…€(Merged Cell) μμ—­μ—μ„λ„ μ •μƒμ μΌλ΅ κ°’μ„ μ½μ–΄μ΄
- λ°μ΄ν„° μ…€ λΉ„μ–΄μμ„ κ²½μ°, λ³‘ν•©λ μƒλ‹¨ μ…€μ—μ„ κ°’ κ°€μ Έμ΄
- DTO ν•„λ“ νƒ€μ…(Integer, Double, String λ“±)μ— λ§μ¶° μλ™ λ³€ν™ μ§€μ›
- λ³€ν™ μ‹¤ν¨ μ‹ `null` μ²λ¦¬ (μμ™Έ λ°μƒ μ—†μ΄ λ¬΄μ‹)

---

#### 2.2.5. μ£Όμμ‚¬ν•­
- DTO ν•„λ“λ…κ³Ό `ExcelHeaderNode`μ fieldNameμ΄ μ •ν™•ν λ§¤μΉ­λμ–΄μ•Ό ν•¨
- λ°μ΄ν„° Rowμ μ»¬λΌ μμ„κ°€ ν—¤λ” leaf λ…Έλ“ μμ„μ™€ λ§μ•„μ•Ό ν•¨
- λ³€ν™ν•  μ μ—†λ” κ°’μ΄ μ΅΄μ¬ν•  κ²½μ° ν•΄λ‹Ή ν•„λ“λ” `null`λ΅ μ±„μ›μ§ μ μμ

---

## 3. μ¶”κ°€ μμ • κΈ°λ¥

- νΉμ • μ»¬λΌλ§ μ„ νƒμ μΌλ΅ autoSize μ μ©
- κ³ μ • μ—΄ λ„λΉ„ μ„¤μ •
- ν—¤λ” λ‹¤κµ­μ–΄ μ§€μ› (i18n)
- λ‹¤μ–‘ν• μ…€ μ¤νƒ€μΌ ν…ν”λ¦Ώ μ§€μ›

---

# β… μ”μ•½
- `generateExcel`κ³Ό `parseExcelToDto` λ‘ κ° λ¨λ‘ λ¬Έμ„ν™” μ™„λ£
- μ‹κ·Έλ‹μ², μ„¤λ…, νλΌλ―Έν„°, νΉμ§•, μ£Όμμ‚¬ν•­ λ¨λ‘ λΉ μ§μ—†μ΄ μ •λ¦¬
- ν•μ‹μ€ Notion μ¤νƒ€μΌ (κ³„μΈµμ  λ§ν¬λ‹¤μ΄)